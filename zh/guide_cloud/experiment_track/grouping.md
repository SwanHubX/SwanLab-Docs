# 分组管理实验

将多个训练和评估运行组合成更大的实验。

## 典型场景

1. **分布式训练**：当实验被拆分成不同的部分，使用独立的训练和评估脚本，需要将它们作为一个整体查看时，可以使用分组功能。
2. **多进程运行**：将多个较小的进程组合成一个实验。
3. **K折交叉验证**：将具有不同随机种子的运行组合成一个完整的实验进行比较。

## 设置分组的方式

### 1. 在代码中设置分组

在初始化实验时传入 `group` 参数，即可将该次运行分配到对应的实验组：

```python
import swanlab

swanlab.init(
    experiment="my_experiment",
    group="experiment_1"  # 所有相关运行使用相同的 group 名称
)
```

每个实验组会拥有独立的详情页面，其中包含该组下的所有子运行。

### 2. 通过环境变量设置分组

使用 `SWANLAB_RUN_GROUP` 环境变量来指定运行的分组：

```python
import os
import swanlab

# 使用 swanlab 内置的 ID 生成器创建唯一分组名称
os.environ["SWANLAB_RUN_GROUP"] = "experiment-" + swanlab.run.get_uuid()[:8]

swanlab.init(experiment="my_experiment")
```

### 3. 在界面中动态分组

SwanLab 支持按任意列对运行进行动态分组，包括隐藏的列。例如，如果使用 `swanlab.config` 记录了批次大小或学习率等超参数，可以直接在网页应用中按这些超参数进行动态分组。

> **注意**：运行列表中的 **分组** 列默认是隐藏的。

按一列或多列对运行进行分组：

1. 点击 **分组** 按钮。
2. 点击一列或多列的名称。
3. 如果选择了多列，拖动它们可以改变分组顺序。
4. 点击表单外的任意位置关闭分组设置。

### 4. 在界面中管理分组

#### 管理单个运行

运行初始化后，可以将其移动到新的分组中。

1. 进入你的 SwanLab 项目。
2. 从项目侧边栏选择 **工作台** 或 **运行** 标签页。
3. 找到要移动的运行，将鼠标悬停在运行名称上，点击三个竖点图标，然后选择 **移动到其他分组**。
4. 要创建新分组，点击 **新建分组**，输入分组名称后提交。
5. 要删除运行，点击三个竖点图标，然后选择 **删除运行**。
6. 要移动运行，从列表中选择目标分组，然后点击 **移动**。

#### 批量管理运行

支持对单个或多个分组中的多个运行进行批量操作。

1. 如有必要，先[启用按列分组](#3-在界面中动态分组)，按 **分组** 列进行分组。
2. 展开某个分组查看其中的运行。在单次批量操作中，可以将不同分组中的运行移动到相同的目标分组。
3. 要选择分组中的所有运行，点击分组名称旁边的复选框。
4. 要选择单个运行，点击它们各自的复选框。
5. 要选择所有分组中的所有运行，点击 **名称** 列标题旁边的复选框。
6. 在表格上方选择批量操作：**标签**、**移动到分组**、**移动到项目** 或 **新建调优**。

#### 创建分组

要创建新的运行分组：

1. 进入你的 SwanLab 项目。
2. 从项目侧边栏选择 **工作台** 或 **运行** 标签页。
3. 点击 **新建分组**，输入分组名称后提交。

#### 删除分组

删除分组只需移除其中的所有运行，分组会自动被删除。

## 自定义运行显示方式

可以从 **工作台** 或 **运行** 标签页自定义运行的显示方式，这两个标签页使用相同的显示配置。

### 管理列

1. 在运行列表上方，点击 **列** 按钮。
2. 点击隐藏列的名称可以显示它，点击可见列的名称可以隐藏它。
   - 支持按列名进行模糊搜索、精确匹配或正则表达式搜索。
   - 拖动列可以改变它们的显示顺序。
3. 点击 **完成** 关闭列浏览器。

### 排序

1. 将鼠标悬停在列名上，点击操作菜单 `...`。
2. 点击 **升序排列** 或 **降序排列**。

### 固定列

固定列会显示在右侧。要固定或取消固定列：

1. 将鼠标悬停在列名上，点击操作菜单 `...`。
2. 点击 **固定列** 或 **取消固定列**。

### 运行名称截断

默认情况下，长的运行名称会在中间截断以提高可读性。要自定义运行名称的截断方式：

1. 点击运行列表上方的操作菜单 `...`。
2. 设置 **运行名称截断** 为截断末尾、中间或开头。

## 分布式训练与分组

假设你在代码中设置了分组，SwanLab 默认会在界面中按分组显示。点击表格上方的 **分组** 按钮可以开启或关闭分组显示。

每个分组在侧边栏中显示为一行，点击 **分组** 行可以进入该实验的详情页面，查看该实验下所有子运行的详细信息。

## 动态分组

可以按任意列对运行进行分组，例如按超参数分组。以下是动态分组的示例效果：

- **侧边栏**：运行按 epoch 数量进行分组。
- **图表**：每条线代表该组的平均值，阴影区域表示方差。可以在图表设置中更改此行为。

## 关闭分组

点击分组按钮并清空分组字段，可以随时关闭分组，表格和图表将恢复到未分组状态。

## 分组图表设置

点击图表右上角的编辑按钮，选择 **高级** 选项卡，可以更改线条和阴影的显示方式。可以为每条线选择平均值、最小值或最大值。对于阴影，可以关闭阴影，或显示最小值和最大值、标准差或标准误差。
